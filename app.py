# -*- coding: utf-8 -*-

"""app.ipynb



Automatically generated by Colab.



Original file is located at

    https://colab.research.google.com/drive/1_MEMUE1sfWJywqw7tsfZUwu7FaIuGk44

"""



import streamlit as st

import numpy as np

import joblib



@st.cache_resource

def load_model():

    return joblib.load("model.pkl")



try:

    model = load_model()

except FileNotFoundError:

    st.error("Model file not found. Please ensure 'model.pkl' is in the same directory.")

    st.stop()





st.title("Bank Marketing Prediction App")

st.write("Predict if a customer will subscribe to a term deposit.")



st.markdown("---")



col1, col2 = st.columns(2)



with col1:

    age = st.number_input("Age", min_value=18, max_value=100, value=30)

    balance = st.number_input("Average Yearly Balance", value=1000)

    day = st.slider("Last Contact Day of Month", 1, 31, 15)

    duration = st.number_input("Last Call Duration (seconds)", min_value=0, value=200)

    campaign = st.number_input("Contacts during this Campaign", min_value=1, value=1)



with col2:

    pdays = st.number_input("Days since last contact (-1 if never)", value=-1)

    previous = st.number_input("Previous contacts before this campaign", min_value=0, value=0)

    job = st.selectbox(

        "Job",

        ["admin.", "blue-collar", "entrepreneur", "housemaid",

         "management", "retired", "self-employed", "services",

         "student", "technician", "unemployed", "unknown"]

    )

    marital = st.selectbox("Marital Status", ["married", "single", "divorced"])

    education = st.selectbox("Education", ["primary", "secondary", "tertiary", "unknown"])



col3, col4, col5 = st.columns(3)



with col3:

    housing = st.selectbox("Housing Loan?", ["yes", "no"])

with col4:

    loan = st.selectbox("Personal Loan?", ["yes", "no"])

with col5:

    default = st.selectbox("Credit Default?", ["no", "yes"])



contact = st.selectbox("Contact Communication", ["cellular", "telephone", "unknown"])

month = st.selectbox(

    "Last Contact Month",

    ["jan", "feb", "mar", "apr", "may", "jun",

     "jul", "aug", "sep", "oct", "nov", "dec"]

)



def preprocess_input():

    binary_map = {"yes": 1, "no": 0}



    job_map = {

        "admin.": 0, "blue-collar": 1, "entrepreneur": 2, "housemaid": 3,

        "management": 4, "retired": 5, "self-employed": 6, "services": 7,

        "student": 8, "technician": 9, "unemployed": 10, "unknown": 11

    }



    marital_map = {"divorced": 0, "married": 1, "single": 2}

    edu_map = {"primary": 0, "secondary": 1, "tertiary": 2, "unknown": 3}

    contact_map = {"cellular": 0, "telephone": 1, "unknown": 2}

    month_map = {

        "jan": 0, "feb": 1, "mar": 2, "apr": 3, "may": 4, "jun": 5,

        "jul": 6, "aug": 7, "sep": 8, "oct": 9, "nov": 10, "dec": 11

    }



    features = [

        age,

        job_map[job],

        marital_map[marital],

        edu_map[education],

        binary_map[default],

        balance,

        binary_map[housing],

        binary_map[loan],

        contact_map[contact],

        day,

        month_map[month],

        duration,

        campaign,

        pdays,

        previous

    ]



    return np.array([features])



st.markdown("---")



if st.button("ðŸ”® Predict"):

    try:

        X_input = preprocess_input()

        prediction = model.predict(X_input)[0]



        st.subheader("Prediction Result")



        if prediction == 1 or prediction == "yes":

            st.success("The customer is likely to subscribe to a term deposit.")

        else:

            st.error("The customer is NOT likely to subscribe.")



        if hasattr(model, "predict_proba"):

            prob = model.predict_proba(X_input)[0]

            st.write(f"Confidence: **{np.max(prob) * 100:.2f}%**")



    except Exception as e:

        st.error("Prediction failed.")

        st.write(e)

        st.info(

            "Ensure the model was trained using exactly 15 features "

            "in the same order as used here."

        )





st.markdown("---")

st.caption("Bank Marketing ML App | Deployed with Streamlit")

